import{r as c,j as e,c as h}from"./client.js";async function d(t){try{return(await chrome.storage.sync.get([t]))[t]||null}catch(n){return console.error(`Failed to get ${t} from storage:`,n),null}}async function u(t,n){try{return await chrome.storage.sync.set({[t]:n}),!0}catch(a){return console.error(`Failed to set ${t} in storage:`,a),!1}}async function p(){return await d("github_auth")}async function l(t){await u("github_auth",t)}async function f(){return await d("repo_config")||{owner:"",repo:"leetcode-solutions",branch:"main",private:!1,folderStructure:"difficulty",includeDescription:!0,includeTestCases:!0}}async function b(t){await u("repo_config",t)}async function y(t){try{const n=await fetch("https://api.github.com/user",{headers:{Authorization:`Bearer ${t}`,Accept:"application/vnd.github.v3+json","User-Agent":"Leet2Git-Extension"}});return n.ok?{valid:!0,username:(await n.json()).login}:{valid:!1,error:"Invalid token"}}catch{return{valid:!1,error:"Failed to verify token"}}}function j(){const[t,n]=c.useState({token:"",username:"",email:"",connected:!1,owner:"",repo:"leetcode-solutions",branch:"main",private:!1,folderStructure:"difficulty",includeDescription:!0,includeTestCases:!0,loading:!1,message:"",messageType:""});c.useEffect(()=>{a()},[]);const a=async()=>{try{const r=await p(),s=await f();n(i=>({...i,token:(r==null?void 0:r.token)||"",username:(r==null?void 0:r.username)||"",email:(r==null?void 0:r.email)||"",connected:(r==null?void 0:r.connected)||!1,owner:s.owner,repo:s.repo,branch:s.branch,private:s.private,folderStructure:s.folderStructure,includeDescription:s.includeDescription,includeTestCases:s.includeTestCases}))}catch(r){console.error("Failed to load settings:",r)}},o=(r,s)=>{n(i=>({...i,message:r,messageType:s})),setTimeout(()=>{n(i=>({...i,message:"",messageType:""}))},5e3)},m=async()=>{if(!t.token.trim()){o("Please enter a GitHub token","error");return}n(r=>({...r,loading:!0}));try{const r=await y(t.token);if(r.valid&&r.username){const s={token:t.token,username:r.username,email:"",connected:!0};await l(s),n(i=>({...i,username:r.username||"",connected:!0,owner:i.owner||r.username||""})),o("GitHub token saved successfully!","success")}else o(r.error||"Invalid GitHub token","error")}catch{o("Failed to verify GitHub token","error")}finally{n(r=>({...r,loading:!1}))}},g=async()=>{if(!t.owner.trim()){o("Repository owner is required","error");return}if(!t.repo.trim()){o("Repository name is required","error");return}n(r=>({...r,loading:!0}));try{const r={owner:t.owner,repo:t.repo,branch:t.branch,private:t.private,folderStructure:t.folderStructure,includeDescription:t.includeDescription,includeTestCases:t.includeTestCases};await b(r),o("Repository configuration saved!","success")}catch{o("Failed to save configuration","error")}finally{n(r=>({...r,loading:!1}))}},x=async()=>{try{await l({token:"",username:"",email:"",connected:!1}),n(r=>({...r,token:"",username:"",email:"",connected:!1})),o("Disconnected from GitHub","success")}catch{o("Failed to disconnect","error")}};return e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:[e.jsxs("div",{className:"flex items-center mb-8",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-indigo-600 to-purple-600 rounded-md flex items-center justify-center mr-3",children:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Leet2Git Options"})]}),t.message&&e.jsx("div",{className:`mb-6 p-4 rounded-lg ${t.messageType==="success"?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800"}`,children:t.message}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),"GitHub Authentication"]}),t.connected?e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-green-800 font-medium",children:["Connected as @",t.username]}),e.jsx("p",{className:"text-green-600 text-sm",children:"GitHub integration is active"})]}),e.jsx("button",{onClick:x,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:"Disconnect"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"GitHub Personal Access Token"}),e.jsx("input",{type:"password",value:t.token,onChange:r=>n(s=>({...s,token:r.target.value})),placeholder:"ghp_xxxxxxxxxxxxxxxxxxxx",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Generate a token at"," ",e.jsx("a",{href:"https://github.com/settings/tokens",target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 hover:underline",children:"github.com/settings/tokens"})," ","with 'repo' scope"]})]}),e.jsx("button",{onClick:m,disabled:t.loading,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-300 transition-colors",children:t.loading?"Verifying...":"Connect GitHub"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"})}),"Repository Configuration"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Repository Owner"}),e.jsx("input",{type:"text",value:t.owner,onChange:r=>n(s=>({...s,owner:r.target.value})),placeholder:"your-username",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Repository Name"}),e.jsx("input",{type:"text",value:t.repo,onChange:r=>n(s=>({...s,repo:r.target.value})),placeholder:"leetcode-solutions",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Branch"}),e.jsx("input",{type:"text",value:t.branch,onChange:r=>n(s=>({...s,branch:r.target.value})),placeholder:"main",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Folder Structure"}),e.jsxs("select",{value:t.folderStructure,onChange:r=>n(s=>({...s,folderStructure:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"difficulty",children:"By Difficulty (easy/, medium/, hard/)"}),e.jsx("option",{value:"topic",children:"By Topic"}),e.jsx("option",{value:"flat",children:"Flat (all in root)"})]})]})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.private,onChange:r=>n(s=>({...s,private:r.target.checked})),className:"w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Create private repository"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.includeDescription,onChange:r=>n(s=>({...s,includeDescription:r.target.checked})),className:"w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Include problem description in files"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.includeTestCases,onChange:r=>n(s=>({...s,includeTestCases:r.target.checked})),className:"w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Include test cases in files"})]})]}),e.jsx("button",{onClick:g,disabled:t.loading,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-gray-300 transition-colors",children:t.loading?"Saving...":"Save Configuration"})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-900 mb-2",children:"How to use:"}),e.jsxs("ol",{className:"text-sm text-blue-800 space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:"Create a GitHub Personal Access Token with 'repo' scope"}),e.jsx("li",{children:'Enter the token above and click "Connect GitHub"'}),e.jsx("li",{children:"Configure your repository settings"}),e.jsx("li",{children:"Solve problems on LeetCode - they'll be automatically synced!"})]})]})]})})}h(document.getElementById("root")).render(e.jsx(j,{}));
